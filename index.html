<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mirth n Mosaic | Innovation Through Harmony</title>
    <meta name="description" content="Mirth n Mosaic blends classical inspiration with modern technological precision to create innovative ecommerce solutions.">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>

    <style>
        /* Base Variables */
        :root {
            --parchment: #F5F2E9;
            --ink: #2C2825;
            --accent-gold: #D4AF37;
            --accent-blue: #1E3F66;
            --accent-red: #8C1C13;
            --te-yellow: #FFE03D;
            --te-gray: #E5E5E5;
            --te-black: #1A1A1A;
            
            --font-serif: 'EB Garamond', Georgia, serif;
            --font-sans: 'Space Mono', monospace;
            --line-height: 1.6;
            
            --grid-size: 8px;
            --golden-ratio: 1.618;
        }
        
        /* Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* Base Typography */
        body {
            font-family: var(--font-serif);
            font-size: 16px;
            line-height: var(--line-height);
            color: var(--ink);
            background-color: var(--parchment);
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden; /* Important for preventing scrollbars from canvas */
        }
        
        h1, h2, h3, h4, h5, h6 {
            font-family: var(--font-sans);
            font-weight: 400;
            letter-spacing: -0.02em;
        }
        
        /* Grid System */
        .grid {
            display: grid;
            gap: calc(var(--grid-size) * 2);
        }
        
        .container {
            width: 92%;
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 calc(var(--grid-size) * 2);
        }
        
        /* Navigation */
        .nav {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: calc(var(--grid-size) * 3) 0;
            z-index: 1000;
            mix-blend-mode: difference; /* This might make nav hard to see over some particle colors */
        }
        
        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-family: var(--font-sans);
            font-size: calc(var(--grid-size) * 3);
            color: white; /* Will be inverted by mix-blend-mode */
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: calc(var(--grid-size) * 1.5);
        }
        
        .logo span {
            display: inline-block;
            width: calc(var(--grid-size) * 4);
            height: calc(var(--grid-size) * 4);
            border: 2px solid var(--te-yellow);
            position: relative;
        }
        
        .logo span::before {
            content: '';
            position: absolute;
            width: 50%;
            height: 50%;
            background-color: var(--te-yellow);
            top: 25%;
            left: 25%;
        }
        
        .nav-items {
            display: flex;
            gap: calc(var(--grid-size) * 4);
        }
        
        .nav-link {
            font-family: var(--font-sans);
            font-size: calc(var(--grid-size) * 1.5);
            color: white; /* Will be inverted by mix-blend-mode */
            text-decoration: none;
            text-transform: uppercase;
            position: relative;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            width: 0;
            height: 1px;
            bottom: -4px;
            left: 0;
            background-color: white;
            transition: width 0.3s ease;
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        .menu-toggle {
            display: none;
            width: calc(var(--grid-size) * 4);
            height: calc(var(--grid-size) * 3);
            flex-direction: column;
            justify-content: space-between;
            cursor: pointer;
        }
        
        .menu-toggle span {
            display: block;
            width: 100%;
            height: 2px;
            background-color: white; /* Will be inverted by mix-blend-mode */
            transition: all 0.3s ease;
        }
        
        /* Hero Section */
        .hero {
            position: relative;
            height: 100vh;
            background-color: var(--te-black); /* Background for the p5 canvas to sit on */
            color: var(--parchment);
            overflow: hidden; /* Ensures canvas doesn't cause scroll */
            display: flex; /* For centering content */
            align-items: center; /* For centering content */
            justify-content: center; /* For centering content */
        }
        
        /* Removed hero-grid as p5 canvas will be the visual focus */
        
        .hero-content {
            position: relative; /* Changed from absolute to work with flex layout */
            text-align: center;
            width: 90%;
            max-width: 800px;
            z-index: 2; /* Ensure content is above p5 canvas */
        }
        
        .hero-title {
            font-size: calc(var(--grid-size) * 7);
            line-height: 1.2;
            margin-bottom: calc(var(--grid-size) * 4);
            position: relative;
        }
        
        .hero-title::after {
            content: '';
            position: absolute;
            width: calc(var(--grid-size) * 12);
            height: 2px;
            background-color: var(--te-yellow);
            bottom: calc(var(--grid-size) * -2);
            left: 50%;
            transform: translateX(-50%);
        }
        
        .hero-subtitle {
            font-family: var(--font-serif);
            font-size: calc(var(--grid-size) * 2.5);
            line-height: 1.5;
            margin-bottom: calc(var(--grid-size) * 6);
            font-weight: 400;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Removed hero-sketch as p5 canvas is the new background */
        
        .hero-cta {
            display: inline-flex;
            gap: calc(var(--grid-size) * 3);
        }
        
        .btn {
            font-family: var(--font-sans);
            font-size: calc(var(--grid-size) * 1.5);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            padding: calc(var(--grid-size) * 1.5) calc(var(--grid-size) * 3);
            border: 1px solid;
            background: transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn-primary {
            border-color: var(--te-yellow);
            color: var(--te-yellow);
        }
        
        .btn-primary:hover {
            background-color: var(--te-yellow);
            color: var(--te-black);
        }
        
        .btn-secondary {
            border-color: var(--parchment);
            color: var(--parchment);
        }
        
        .btn-secondary:hover {
            background-color: var(--parchment);
            color: var(--te-black);
        }

        /* p5.js Canvas Container Styling */
        .p5-container {
            position: absolute; /* Changed from fixed to be contained within .hero */
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1; /* Behind hero-content but above hero background */
            pointer-events: none; /* Allows clicks to pass through to elements behind if any */
        }

        /* Ensure canvas itself takes up the container and is behind content */
        #p5-container canvas {
            display: block;
            width: 100% !important; /* Override p5.js inline styles */
            height: 100% !important; /* Override p5.js inline styles */
        }
        
        /* About Section */
        .about {
            padding: calc(var(--grid-size) * 20) 0;
            position: relative;
            background-color: var(--parchment); /* Ensure sections below hero have their own background */
        }
        
        .about-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: calc(var(--grid-size) * 10);
            align-items: center;
        }
        
        .section-title {
            font-family: var(--font-sans);
            font-size: calc(var(--grid-size) * 5);
            margin-bottom: calc(var(--grid-size) * 5);
            position: relative;
            line-height: 1.2;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            width: calc(var(--grid-size) * 8);
            height: 2px;
            background-color: var(--accent-gold);
            bottom: calc(var(--grid-size) * -2);
            left: 0;
        }
        
        .about-text p {
            font-size: calc(var(--grid-size) * 2.25);
            margin-bottom: calc(var(--grid-size) * 3);
        }
        
        .about-image {
            position: relative;
        }
        
        .about-image::before {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border: 1px solid var(--accent-gold);
            top: calc(var(--grid-size) * 2);
            left: calc(var(--grid-size) * 2);
            z-index: 1;
        }
        
        .about-image img {
            position: relative;
            z-index: 2;
            width: 100%;
            height: auto;
            display: block;
            box-shadow: 0 calc(var(--grid-size) * 2) calc(var(--grid-size) * 4) rgba(0,0,0,0.1);
            /* Fallback for image loading */
            background: var(--te-gray) url('https://placehold.co/600x400/E5E5E5/2C2825?text=Mirth+n+Mosaic') no-repeat center center;
            background-size: cover;
        }
        
        .about-notes {
            position: absolute;
            width: calc(var(--grid-size) * 30);
            transform: rotate(-5deg);
            top: calc(var(--grid-size) * 15);
            right: calc(var(--grid-size) * 5);
            opacity: 0.1;
            pointer-events: none;
            z-index: 0;
        }
        
        /* Portfolio Section */
        .portfolio {
            padding: calc(var(--grid-size) * 20) 0;
            background-color: var(--te-black);
            color: var(--parchment);
            position: relative;
        }
        
        .portfolio .section-title {
            color: var(--parchment);
            margin-bottom: calc(var(--grid-size) * 8);
            text-align: center;
        }
        
        .portfolio .section-title::after {
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--te-yellow); /* Match portfolio theme */
        }
        
        .companies-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(calc(var(--grid-size) * 35), 1fr));
            gap: calc(var(--grid-size) * 4);
        }
        
        .company-card {
            border: 1px solid var(--te-gray);
            padding: calc(var(--grid-size) * 4);
            display: flex;
            flex-direction: column;
            height: 100%;
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
            background-color: var(--te-black); /* Ensure cards have background */
        }
        
        .company-card:hover {
            border-color: var(--te-yellow);
            transform: translateY(calc(var(--grid-size) * -1));
        }
        
        .company-card:hover .company-icon {
            transform: rotate(15deg) scale(1.1);
        }
        
        .company-number {
            font-family: var(--font-sans);
            font-size: calc(var(--grid-size) * 1.5);
            color: var(--te-gray);
            margin-bottom: calc(var(--grid-size) * 3);
            display: block;
        }
        
        .company-icon {
            width: calc(var(--grid-size) * 6);
            height: calc(var(--grid-size) * 6);
            margin-bottom: calc(var(--grid-size) * 4);
            transition: all 0.3s ease;
            transform-origin: center;
            color: var(--te-yellow); /* Ensure icons are visible */
        }
        .company-icon svg path, .company-icon svg circle, .company-icon svg rect {
             stroke: var(--te-yellow); /* Explicitly color SVG strokes */
        }
        
        .company-title {
            font-family: var(--font-sans);
            font-size: calc(var(--grid-size) * 3);
            margin-bottom: calc(var(--grid-size) * 2);
            line-height: 1.2;
            color: var(--parchment);
        }
        
        .company-description {
            font-size: calc(var(--grid-size) * 2);
            line-height: var(--line-height);
            flex-grow: 1;
            margin-bottom: calc(var(--grid-size) * 3);
            color: var(--te-gray);
        }
        
        .company-link {
            font-family: var(--font-sans);
            font-size: calc(var(--grid-size) * 1.5);
            color: var(--te-yellow);
            text-decoration: none;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            align-self: flex-start;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .company-link::after {
            content: '→';
            margin-left: calc(var(--grid-size) * 1);
            transition: margin-left 0.3s ease;
        }
        
        .company-link:hover {
            color: var(--parchment);
        }
        
        .company-link:hover::after {
            margin-left: calc(var(--grid-size) * 1.5);
        }
        
        .portfolio-sketch {
            position: absolute;
            bottom: calc(var(--grid-size) * 10);
            left: calc(var(--grid-size) * 5);
            width: calc(var(--grid-size) * 25);
            height: auto;
            opacity: 0.05;
            pointer-events: none;
        }
        
        /* Values Section */
        .values {
            padding: calc(var(--grid-size) * 20) 0;
            position: relative;
            overflow: hidden;
            background-color: var(--parchment); /* Ensure section background */
        }
        
        .values-container {
            position: relative;
            z-index: 2;
        }
        
        .values .section-title {
            text-align: center;
            margin-bottom: calc(var(--grid-size) * 10);
            color: var(--ink); /* Ensure title is visible */
        }
        
        .values .section-title::after {
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--accent-gold);
        }
        
        .values-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(calc(var(--grid-size) * 30), 1fr));
            gap: calc(var(--grid-size) * 5);
        }
        
        .value-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: calc(var(--grid-size) * 4);
            position: relative;
        }
        
        .value-item::before {
            content: '';
            position: absolute;
            width: 1px;
            height: 100%;
            background-color: var(--accent-gold);
            opacity: 0.3;
            left: 0;
            top: 0;
        }
        
        .value-number {
            font-family: var(--font-sans);
            font-size: calc(var(--grid-size) * 5);
            color: var(--accent-gold);
            opacity: 0.2;
            margin-bottom: calc(var(--grid-size) * 2);
        }
        
        .value-icon {
            width: calc(var(--grid-size) * 8);
            height: calc(var(--grid-size) * 8);
            margin-bottom: calc(var(--grid-size) * 3);
            color: var(--accent-blue); /* Ensure icons are visible */
        }
         .value-icon svg path, .value-icon svg circle, .value-icon svg rect {
             stroke: var(--accent-blue); /* Explicitly color SVG strokes */
        }
        
        .value-title {
            font-family: var(--font-sans);
            font-size: calc(var(--grid-size) * 2.5);
            margin-bottom: calc(var(--grid-size) * 2);
            color: var(--ink);
        }
        
        .value-description {
            font-size: calc(var(--grid-size) * 2);
            color: var(--ink);
        }
        
        .values-sketch {
            position: absolute;
            width: calc(var(--grid-size) * 60);
            height: calc(var(--grid-size) * 60);
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0.03;
            pointer-events: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 500'%3E%3Ccircle cx='250' cy='250' r='200' fill='none' stroke='%232C2825' stroke-width='1'/%3E%3Ccircle cx='250' cy='250' r='150' fill='none' stroke='%232C2825' stroke-width='1'/%3E%3Ccircle cx='250' cy='250' r='100' fill='none' stroke='%232C2825' stroke-width='1'/%3E%3Ccircle cx='250' cy='250' r='50' fill='none' stroke='%232C2825' stroke-width='1'/%3E%3Cline x1='50' y1='250' x2='450' y2='250' stroke='%232C2825' stroke-width='1'/%3E%3Cline x1='250' y1='50' x2='250' y2='450' stroke='%232C2825' stroke-width='1'/%3E%3C/svg%3E");
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
        }
        
        /* CTA Section */
        .cta {
            padding: calc(var(--grid-size) * 15) 0;
            background-color: var(--te-yellow);
            color: var(--te-black);
            position: relative;
            overflow: hidden;
        }
        
        .cta-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            position: relative;
            z-index: 2;
        }
        
        .cta-title {
            font-family: var(--font-sans);
            font-size: calc(var(--grid-size) * 5);
            margin-bottom: calc(var(--grid-size) * 3);
            max-width: 800px;
            line-height: 1.2;
        }
        
        .cta-text {
            font-size: calc(var(--grid-size) * 2.25);
            max-width: 600px;
            margin-bottom: calc(var(--grid-size) * 6);
        }
        
        .cta .btn-primary { /* This was btn-secondary in original, making it primary for consistency */
            border-color: var(--te-black);
            color: var(--te-black);
        }
        
        .cta .btn-primary:hover {
            background-color: var(--te-black);
            color: var(--te-yellow);
        }
        
        .cta-pattern {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            opacity: 0.1;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20'%3E%3Crect width='20' height='20' fill='none'/%3E%3Cpath d='M0,10 L20,10 M10,0 L10,20' stroke='%231A1A1A' stroke-width='1'/%3E%3C/svg%3E");
            background-size: calc(var(--grid-size) * 2) calc(var(--grid-size) * 2);
            pointer-events: none;
        }
        
        /* Footer */
        .footer {
            padding: calc(var(--grid-size) * 10) 0 calc(var(--grid-size) * 5);
            background-color: var(--te-black);
            color: var(--parchment);
        }
        
        .footer-grid {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: calc(var(--grid-size) * 5);
            margin-bottom: calc(var(--grid-size) * 10);
        }
        
        .footer-brand h3 {
            font-family: var(--font-sans);
            font-size: calc(var(--grid-size) * 3);
            margin-bottom: calc(var(--grid-size) * 3);
        }
        
        .footer-brand p {
            font-size: calc(var(--grid-size) * 2);
            margin-bottom: calc(var(--grid-size) * 4);
        }
        
        .social-links {
            display: flex;
            gap: calc(var(--grid-size) * 2);
        }
        
        .social-link { /* Added basic styling for potential social icons */
            width: calc(var(--grid-size) * 4);
            height: calc(var(--grid-size) * 4);
            border: 1px solid var(--te-gray);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--te-gray);
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: calc(var(--grid-size) * 2); /* For icon fonts */
        }
        
        .social-link:hover {
            border-color: var(--te-yellow);
            color: var(--te-yellow);
            transform: translateY(calc(var(--grid-size) * -0.5));
        }
        
        .footer-nav h4, .footer-contact h4 {
            font-family: var(--font-sans);
            font-size: calc(var(--grid-size) * 2);
            margin-bottom: calc(var(--grid-size) * 3);
            color: var(--te-gray);
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: calc(var(--grid-size) * 1.5);
        }
        
        .footer-links a {
            font-size: calc(var(--grid-size) * 2);
            color: var(--parchment);
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        .footer-links a:hover {
            color: var(--te-yellow);
            padding-left: calc(var(--grid-size) * 0.5);
        }
        
        .contact-info {
            list-style: none;
        }
        
        .contact-info li {
            display: flex;
            gap: calc(var(--grid-size) * 1.5);
            margin-bottom: calc(var(--grid-size) * 2);
            font-size: calc(var(--grid-size) * 2);
            color: var(--parchment);
        }
         /* Basic icon styling if using font awesome or similar */
        .contact-info li i {
            width: calc(var(--grid-size) * 2.5); 
            text-align: center;
        }
        
        .copyright {
            text-align: center;
            font-size: calc(var(--grid-size) * 1.5);
            color: var(--te-gray);
            border-top: 1px solid rgba(229, 229, 229, 0.1);
            padding-top: calc(var(--grid-size) * 3);
        }
        
        /* Vitruvian cursor styling */
        .custom-cursor {
            position: fixed;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 1px solid var(--accent-gold);
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 9999;
            mix-blend-mode: difference; /* Cursor will invert colors it passes over */
        }
        
        .cursor-dot {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 4px;
            height: 4px;
            background-color: var(--te-yellow); /* Dot color */
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        /* Modal Styles */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1001; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.6); /* Darker overlay */
            padding-top: 60px;
        }

        .modal-content {
            background-color: var(--parchment);
            color: var(--ink);
            margin: 5% auto;
            padding: calc(var(--grid-size) * 4);
            border: 1px solid var(--accent-gold);
            width: 80%;
            max-width: 700px;
            border-radius: 8px;
            position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .modal-content h2 {
            font-family: var(--font-sans);
            color: var(--accent-blue);
            margin-top: 0;
            margin-bottom: calc(var(--grid-size) * 2);
        }
         .modal-content h3 {
            font-family: var(--font-sans);
            color: var(--ink);
            margin-top: calc(var(--grid-size) * 2.5);
            font-size: 1.1em;
        }
        .modal-content p, .modal-content ul {
            font-family: var(--font-serif);
            line-height: var(--line-height);
            margin-bottom: calc(var(--grid-size) * 2);
        }
        .modal-content ul {
            padding-left: calc(var(--grid-size) * 3);
        }
        .modal-content a {
            color: var(--accent-blue);
            text-decoration: underline;
        }
        .modal-content a:hover {
            color: var(--accent-red);
        }

        .close-btn {
            color: var(--accent-red);
            float: right;
            font-size: calc(var(--grid-size) * 4);
            font-weight: bold;
            line-height: 1;
        }

        .close-btn:hover,
        .close-btn:focus {
            color: var(--ink);
            text-decoration: none;
            cursor: pointer;
        }

        .footer-modal-links {
            text-align: center;
            padding: calc(var(--grid-size) * 2) 0;
            border-top: 1px solid rgba(229, 229, 229, 0.2); /* Slightly more visible line */
            margin-top: calc(var(--grid-size) * 5);
        }

        .footer-modal-links a {
            font-family: var(--font-sans);
            font-size: calc(var(--grid-size) * 1.75);
            color: var(--parchment);
            text-decoration: underline;
            margin: 0 calc(var(--grid-size) * 1.5);
            cursor: pointer;
        }
        .footer-modal-links a:hover {
            color: var(--te-yellow);
        }
        
        /* Responsive Styles */
        @media (max-width: 1024px) {
            :root {
                --grid-size: 7px;
            }
            .hero-title { font-size: calc(var(--grid-size) * 6); }
            .hero-subtitle { font-size: calc(var(--grid-size) * 2.25); }
            .footer-grid {
                grid-template-columns: 1fr 1fr;
                row-gap: calc(var(--grid-size) * 8);
            }
             .about-container {
                grid-template-columns: 1fr;
                gap: calc(var(--grid-size) * 6);
            }
            .about-image {
                order: -1; /* Image first on tablet */
                margin-bottom: calc(var(--grid-size) * 5);
            }
        }
        
        @media (max-width: 768px) {
            :root {
                --grid-size: 6px;
            }
            
            .nav-items {
                position: fixed;
                top: 0;
                right: -100%; /* Start off-screen */
                width: 70%;
                max-width: 300px; /* Max width for menu */
                height: 100vh;
                background-color: rgba(26, 26, 26, 0.95); /* Slightly transparent TE Black */
                backdrop-filter: blur(5px);
                flex-direction: column;
                align-items: center;
                justify-content: center;
                transition: right 0.35s cubic-bezier(0.23, 1, 0.32, 1); /* Smoother transition */
                padding: calc(var(--grid-size) * 5);
                z-index: 999; /* Below toggle, above content */
            }
            
            .nav-items.active {
                right: 0;
            }
            
            .menu-toggle {
                display: flex;
                z-index: 1001; /* Above nav items */
            }
            
            .menu-toggle.active span:nth-child(1) {
                transform: translateY(calc(var(--grid-size) * 1.1)) rotate(45deg); /* Adjusted for 6px grid */
            }
            
            .menu-toggle.active span:nth-child(2) {
                opacity: 0;
            }
            
            .menu-toggle.active span:nth-child(3) {
                transform: translateY(calc(var(--grid-size) * -1.1)) rotate(-45deg); /* Adjusted for 6px grid */
            }
            
            .companies-grid {
                grid-template-columns: 1fr; /* Single column for company cards */
            }
            
            .footer-grid {
                grid-template-columns: 1fr;
                gap: calc(var(--grid-size) * 6); /* Reduced gap */
            }
            .modal-content {
                width: 90%;
                padding: calc(var(--grid-size) * 3);
            }
            .hero-title { font-size: calc(var(--grid-size) * 5); }
            .hero-subtitle { font-size: calc(var(--grid-size) * 2); }
        }
        
        @media (max-width: 480px) {
             :root {
                --grid-size: 5.5px; /* Fine-tune for small screens */
            }
            .hero-title { font-size: calc(var(--grid-size) * 4.5); }
            .hero-subtitle { font-size: calc(var(--grid-size) * 1.8); }
            .btn { font-size: calc(var(--grid-size) * 1.75); padding: calc(var(--grid-size) * 1.25) calc(var(--grid-size) * 2.5); }
            .section-title { font-size: calc(var(--grid-size) * 4); }
            .about-text p { font-size: calc(var(--grid-size) * 2); }
            .company-title { font-size: calc(var(--grid-size) * 2.5); }
            .company-description { font-size: calc(var(--grid-size) * 1.8); }
            .value-title { font-size: calc(var(--grid-size) * 2.25); }
            .value-description { font-size: calc(var(--grid-size) * 1.8); }
            .cta-title { font-size: calc(var(--grid-size) * 4); }
            .cta-text { font-size: calc(var(--grid-size) * 2); }
            .footer-modal-links a { font-size: calc(var(--grid-size) * 1.5); margin: 0 calc(var(--grid-size) * 1); }
        }
    </style>
</head>
<body>
    <div class="custom-cursor">
        <div class="cursor-dot"></div>
    </div>
    
    <header class="nav">
        <div class="container nav-container">
            <a href="#" class="logo">
                <span></span>
                Mirth n Mosaic
            </a>
            <div class="nav-items">
                <a href="#about" class="nav-link">About</a>
                <a href="#portfolio" class="nav-link">Companies</a>
                <a href="#values" class="nav-link">Values</a>
                <a href="#contact" class="nav-link">Contact</a>
            </div>
            <div class="menu-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </header>
    
    <section class="hero">
        <div class="p5-container" id="p5-container"></div> <div class="hero-content">
            <h1 class="hero-title">Innovation Through Harmony</h1>
            <p class="hero-subtitle">We blend timeless principles with cutting-edge technology to create ecommerce solutions that are both functional and beautiful.</p>
            <div class="hero-cta">
                <a href="#portfolio" class="btn btn-primary">Discover Our Companies</a>
                <a href="mailto:contact@mirthnmosaic.com" class="btn btn-secondary">Connect With Us</a>
            </div>
        </div>
    </section>
    
    <section class="about" id="about">
        <div class="container about-container">
            <div class="about-text">
                <h2 class="section-title">The Science of Commerce</h2>
                <p>Mirth n Mosaic draws inspiration from the Renaissance ideal of merging art and science. Like da Vinci's anatomical studies revealed the inner workings of humanity, we dissect the structure of commerce to create more perfect systems.</p>
                <p>Our name reflects our dual nature: "Mirth" represents the joy and satisfaction our solutions bring, while "Mosaic" embodies our diverse portfolio of companies working in harmony toward a unified vision.</p>
                <p>As a parent company, we cultivate pioneering ecommerce technologies through a blend of rigorous analysis and inventive design, balancing mathematical precision with intuitive interfaces.</p>
            </div>
            <div class="about-image">
                <img src="images/about.png" alt="Mirth n Mosaic conceptual illustration" onerror="this.onerror=null;this.src='https://placehold.co/600x400/E5E5E5/2C2825?text=Image+Not+Found';">
            </div>
        </div>
        <div class="about-notes"></div> </section>
    
    <section class="portfolio" id="portfolio">
        <div class="container">
            <h2 class="section-title">Our Family of Companies & Products</h2>
            <div class="companies-grid">
                <div class="company-card">
                    <span class="company-number">01</span>
                    <div class="company-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M10.59,13.41C11.44,12.57 12,11.35 12,10C12,7.24 7.76,5 5,5C3.54,5 2.22,5.57 1.21,6.45M12,10C12,12.24 16.24,14 19,14C20.46,14 21.78,13.43 22.79,12.55M17.59,18.41C18.44,17.57 19,16.35 19,15C19,12.24 14.76,10 12,10M5,15C5,16.35 5.56,17.57 6.41,18.41L5,20L3.59,18.41C2.56,17.43 2,16.27 2,15C2,12.24 6.24,10 9,10C9.69,10 10.36,10.12 10.97,10.34" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <circle cx="12" cy="10" r="3" stroke-width="1.5"/>
                            <path d="M9,10 C9,8 10,7 12,7" stroke-width="1.5"/>
                            <path d="M15,10 C15,8 14,7 12,7" stroke-width="1.5"/>
                            <path d="M12,13 C14,13 15,12 15,10" stroke-width="1.5"/>
                            <path d="M12,13 C10,13 9,12 9,10" stroke-width="1.5"/>
                        </svg>
                    </div>
                    <h3 class="company-title">OctoMindAI</h3>
                    <p class="company-description">Your on-demand AI Automation Studio. OctoMindAI plugs advanced workflows, applications and agents into everyday workflows—slashing busy-work for founders and SMBs while unlocking up to 30× productivity gains. From data-driven decision dashboards to hands-off process bots, we design, deploy, and support AI systems that just work.</p>
                    <a href="#" class="company-link">Explore OctoMindAI</a>
                </div>
                <div class="company-card">
                    <span class="company-number">02</span>
                     <div class="company-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L12 5M12 19L12 22M5 12L2 12M22 12L19 12M7.05029 7.05025L4.92908 4.92903M19.0711 19.071L16.9498 16.9497M7.05029 16.9497L4.92908 19.071M19.0711 4.92903L16.9498 7.05025" stroke-width="1.5" stroke-linecap="round"/>
                            <path d="M9 14C9.5 15.5 10.5 17 12 17C13.5 17 14.5 15.5 15 14C14.5 12.5 13.5 10 12 10C10.5 10 9.5 12.5 9 14Z" stroke-width="1.5"/>
                            <path d="M12 17V19" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <h3 class="company-title">IdeaSpark</h3>
                    <p class="company-description">Instant product blueprints for builders. Drop your app idea, and IdeaSpark returns a polished, developer-ready spec (tech stack, user stories, wireframes, and go-to-market notes) in minutes—so you can skip the guesswork and ship faster.</p>
                    <a href="#" class="company-link">Explore IdeaSpark</a>
                </div>
                <div class="company-card">
                    <span class="company-number">03</span>
                    <div class="company-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L7 7L12 12L17 7L12 2Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M7 7H3V17H7V7Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M17 7H21V17H17V7Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M7 17L12 22L17 17" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 12V22" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <h3 class="company-title">AdAlchemist</h3>
                    <p class="company-description">Turn raw concepts into gold-standard ad creative. AdAlchemist ingests your offer, audience, and brand voice, then spins up conversion-focused copy, visuals, and A/B test plans—automatically optimized for every channel, from Meta to TikTok.</p>
                    <a href="#" class="company-link">Explore AdAlchemist</a>
                </div>
                <div class="company-card">
                    <span class="company-number">04</span>
                    <div class="company-icon">
                       <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 12C14.2091 12 16 10.2091 16 8C16 5.79086 14.2091 4 12 4C9.79086 4 8 5.79086 8 8C8 10.2091 9.79086 12 12 12Z" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M20 19C20 16.2386 16.4183 14 12 14C7.58172 14 4 16.2386 4 19" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M15 8H17" stroke-width="1.5" stroke-linecap="round"/>
                            <path d="M7 8H9" stroke-width="1.5" stroke-linecap="round"/>
                            <path d="M12 4V2" stroke-width="1.5" stroke-linecap="round"/>
                            <path d="M12 20V22" stroke-width="1.5" stroke-linecap="round"/>
                            <path d="M4.92896 4.92896L3.51475 3.51475" stroke-width="1.5" stroke-linecap="round"/>
                            <path d="M20.4852 20.4853L19.071 19.0711" stroke-width="1.5" stroke-linecap="round"/>
                            <path d="M4.92896 19.0711L3.51475 20.4853" stroke-width="1.5" stroke-linecap="round"/>
                            <path d="M20.4852 3.51475L19.071 4.92896" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <h3 class="company-title">AIHeadShots</h3>
                    <p class="company-description">Studio-quality headshots without the studio. Upload a few selfies and receive professional, LinkedIn-ready portraits in under an hour—retouched, backdrop-matched, and royalty-free.</p>
                    <a href="#" class="company-link">Explore AIHeadShots</a>
                </div>
            </div>
        </div>
        </section>
    
    <section class="values" id="values">
        <div class="container values-container">
            <h2 class="section-title">Principles That Guide Us</h2>
            <div class="values-grid">
                <div class="value-item">
                    <span class="value-number">01</span>
                    <div class="value-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8 12H16" stroke-width="1.5" stroke-linecap="round"/>
                            <path d="M12 16V8" stroke-width="1.5" stroke-linecap="round"/>
                            <circle cx="12" cy="12" r="9" stroke-width="1.5"/>
                        </svg>
                    </div>
                    <h3 class="value-title">Artful Innovation</h3>
                    <p class="value-description">We approach problems with the curious mind of an inventor, drawing connections between seemingly unrelated fields to create novel solutions.</p>
                </div>
                <div class="value-item">
                    <span class="value-number">02</span>
                    <div class="value-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="4" y="4" width="16" height="16" rx="2" stroke-width="1.5"/>
                            <path d="M4 12H20" stroke-width="1.5"/>
                            <path d="M12 4V20" stroke-width="1.5"/>
                        </svg>
                    </div>
                    <h3 class="value-title">Golden Proportion</h3>
                    <p class="value-description">We believe in balance between form and function, creating systems with mathematical precision that also feel intuitive and harmonious.</p>
                </div>
                <div class="value-item">
                    <span class="value-number">03</span>
                    <div class="value-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="12" cy="12" r="9" stroke-width="1.5"/>
                            <circle cx="12" cy="12" r="5" stroke-width="1.5"/>
                            <path d="M12 3V21" stroke-width="1.5" stroke-dasharray="1 3"/>
                            <path d="M3 12H21" stroke-width="1.5" stroke-dasharray="1 3"/>
                        </svg>
                    </div>
                    <h3 class="value-title">Analytical Curiosity</h3>
                    <p class="value-description">Like da Vinci's scientific approach to art, we meticulously study commerce patterns to understand the underlying principles that drive success.</p>
                </div>
                <div class="value-item">
                    <span class="value-number">04</span>
                    <div class="value-icon">
                        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 3L4 9V21H20V9L12 3Z" stroke-width="1.5"/>
                            <path d="M16 13H8V21H16V13Z" stroke-width="1.5"/>
                            <path d="M12 13V21" stroke-width="1.5"/>
                        </svg>
                    </div>
                    <h3 class="value-title">Sustainable Design</h3>
                    <p class="value-description">We create systems built to last, with modular components and adaptable architectures that can evolve with changing market conditions.</p>
                </div>
            </div>
        </div>
        <div class="values-sketch"></div>
    </section>
    
    <section class="cta">
        <div class="cta-pattern"></div>
        <div class="container cta-container">
            <h2 class="cta-title">Ready to Transform Your Ecommerce Experience?</h2>
            <p class="cta-text">Discover how our family of companies can bring mathematical precision and artistic beauty to your digital commerce strategy.</p>
            <a href="mailto:contact@mirthnmosaic.com" class="btn btn-primary">Connect With Us</a> </section>
    
    <footer class="footer" id="contact">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <h3>Mirth n Mosaic</h3>
                    <p>Elevating ecommerce technology through a perfect fusion of classical principles and modern innovation.</p>
                    <div class="social-links">
                         </div>
                </div>
                <div class="footer-nav">
                    <h4>Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="#about">About Us</a></li>
                        <li><a href="#portfolio">Our Companies</a></li>
                        <li><a href="#values">Our Values</a></li>
                    </ul>
                </div>
                <div class="footer-nav">
                    <h4>Our Companies</h4>
                    <ul class="footer-links">
                        <li><a href="#">OctoMindAI</a></li>
                        <li><a href="#">IdeaSpark</a></li>
                        <li><a href="#">AdAlchemist</a></li>
                        <li><a href="#">AIHeadShots</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h4>Contact Us</h4>
                    <ul class="contact-info">
                        <li>Email: info@mirthnmosaic.com</li>
                    </ul>
                </div>
            </div>
             <div class="footer-modal-links">
                <a onclick="openModal('refundModal')">Refund & Dispute Policy</a>
                <a onclick="openModal('legalModal')">Legal & Export Compliance</a>
                <a onclick="openModal('promoModal')">Promotion Terms</a>
            </div>
            <div class="copyright">
                <p>&copy; 2025 Mirth n Mosaic. All Rights Reserved.</p>
            </div>
        </div>
    </footer>

    <div id="refundModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('refundModal')">&times;</span>
            <h2>📄 Refund & Dispute Policy</h2>
            <p><strong>Effective date:</strong> 5/8/2025</p>
            <p>All sales are final. Mirth n Mosaic and its subsidiary products (e.g. IdeaSpark) deliver non-tangible, irrevocable digital services and software access. Once an order is confirmed and service is rendered or access granted, we cannot offer refunds, returns, chargebacks, or exchanges.</p>
            <h3>Service errors or Defects</h3>
            <p>If you believe a technical error prevented you from receiving or using the purchased service or product as described, please contact our support team at <a href="mailto:support@mirthnmosaic.com">support@mirthnmosaic.com</a> (or the specific product's support email) within 7 calendar days of purchase. We will investigate the issue and, if a verifiable error or defect directly attributable to our systems is found, we will make reasonable efforts to provide a corrected service, access, or digital file at no additional charge. The determination of a verifiable error and the appropriate remedy will be at our sole discretion.</p>
            <h3>Disputes</h3>
            <p>Initiating a payment dispute or chargeback with your financial institution without first contacting us to resolve the issue may result in the immediate suspension of your service access and may delay resolution. We aim to respond to all support emails within 2-3 business days.</p>
            <h3>Governing law</h3>
            <p>This policy is governed by the laws of the State of Florida, USA.</p>
        </div>
    </div>

    <div id="legalModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('legalModal')">&times;</span>
            <h2>🌐 Legal & Export Compliance Statement</h2>
            <p>Mirth n Mosaic LLC and its associated products and services (collectively, "Services") provide software-as-a-service, AI-generated digital content, and related offerings. No physical goods are typically involved, and controlled technical data is handled according to applicable laws. We are committed to observing U.S. export regulations and other relevant legal frameworks:</p>
            <ul>
                <li><strong>Sanctioned Regions:</strong> We do not offer Services to individuals or entities located in, or ordinarily resident in, embargoed or OFAC-sanctioned jurisdictions (e.g., Cuba, Iran, North Korea, Syria, the Russian Federation, and the Crimea, Donetsk, and Luhansk regions of Ukraine). This list is subject to change based on U.S. government actions.</li>
                <li><strong>Restricted Parties:</strong> We do not knowingly transact with, or allow use of our Services by, anyone on U.S. government denied-party lists, Specially Designated Nationals (SDN) lists, or other applicable sanctions lists.</li>
                <li><strong>User Responsibility:</strong> By using our Services, you represent and warrant that you are not located in, under the control of, or a national or resident of any restricted region, and that you are not a restricted party. You agree not to use or facilitate the use of our Services for any purpose prohibited by U.S. law, including the development, design, manufacture, or production of nuclear, chemical, or biological weapons, or missile proliferation. You are responsible for complying with all local laws regarding online conduct and acceptable content, as well as all applicable export and re-export control laws and regulations.</li>
            </ul>
            <p>If you have questions regarding export controls or legal compliance, please contact <a href="mailto:legal@mirthnmosaic.com">legal@mirthnmosaic.com</a>.</p>
        </div>
    </div>

    <div id="promoModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal('promoModal')">&times;</span>
            <h2>🎁 Promotion Terms & Conditions</h2>
            <p>These Promotion Terms & Conditions apply to all coupons, discounts, trials, and limited-time offers (“Promotions”) issued by Mirth n Mosaic LLC or its subsidiary products (e.g., IdeaSpark) unless a specific promotion's landing page or direct communication explicitly states otherwise.</p>
            <ul>
                <li><strong>Eligibility & Validity:</strong> Promotions are valid only for the period specified in the offer. They may be subject to additional eligibility criteria (e.g., new customers only, specific service plans). Promotions are void where prohibited by law.</li>
                <li><strong>Non-Transferable & No Cash Value:</strong> Promotional codes are typically for single use by the intended recipient or account holder and cannot be transferred, sold, or exchanged for cash, credit, or other services.</li>
                <li><strong>Limitations:</strong> Promotions cannot usually be combined with other offers, discounts, or bulk-pricing arrangements unless explicitly stated. Limit one promotion per customer or account per offer period, as applicable. Promotions do not apply to taxes or other fees unless specified.</li>
                <li><strong>Redemption:</strong> Instructions for redeeming a promotion will be provided with the offer. Failure to follow redemption instructions may result in the inability to apply the discount.</li>
                <li><strong>Modification & Withdrawal:</strong> We reserve the right to modify, suspend, or cancel any promotion at our sole discretion, at any time, and without prior notice. However, if a promotion is redeemed before such modification or cancellation, the original terms at the time of redemption will generally be honored, unless abuse or error is detected.</li>
                <li><strong>Abuse & Fraud:</strong> Any suspected fraudulent activity, misuse, or abuse of promotions (e.g., creating multiple accounts to redeem a new-customer offer) will result in the immediate invalidation of the discount, potential termination of service, and other remedies as permitted by law.</li>
                <li><strong>Liability:</strong> Mirth n Mosaic is not liable for any losses arising from an inability to redeem a promotion due to user error, an expired offer, technical issues beyond our reasonable control, or other circumstances not directly attributable to our gross negligence.</li>
                <li><strong>Governing Law:</strong> Promotions and these terms are governed by the laws of the State of Florida, USA.</li>
            </ul>
        </div>
    </div>
    
    <script>
        // Mobile menu toggle
        const menuToggle = document.querySelector('.menu-toggle');
        const navItems = document.querySelector('.nav-items');
        
        menuToggle.addEventListener('click', () => {
            navItems.classList.toggle('active');
            menuToggle.classList.toggle('active');
        });
        
        // Smooth scrolling for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                
                const targetId = this.getAttribute('href');
                // Check if it's a modal link or a section link
                if (targetId.startsWith('#') && targetId.length > 1 && !this.onclick) {
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - (document.querySelector('.nav')?.offsetHeight || 0), // Adjust for fixed nav
                            behavior: 'smooth'
                        });
                        
                        // Close mobile menu if open and active
                        if (navItems.classList.contains('active')) {
                            navItems.classList.remove('active');
                            menuToggle.classList.remove('active');
                        }
                    }
                }
            });
        });
        
        // Custom cursor
        const cursor = document.querySelector('.custom-cursor');
        if (cursor) { // Check if cursor element exists
            document.addEventListener('mousemove', (e) => {
                cursor.style.left = e.clientX + 'px';
                cursor.style.top = e.clientY + 'px';
            });
        }
        
        // Section animations on scroll
        const sections = document.querySelectorAll('section');
        const heroSection = document.querySelector('.hero');

        function checkScroll() {
            const triggerBottom = window.innerHeight * 0.8;
            
            sections.forEach(section => {
                if (section === heroSection) return; // Skip hero for this animation

                const sectionTop = section.getBoundingClientRect().top;
                
                if (sectionTop < triggerBottom) {
                    section.style.opacity = '1';
                    section.style.transform = 'translateY(0)';
                } else { // Optional: Reset if scrolled back up past trigger
                    // section.style.opacity = '0';
                    // section.style.transform = 'translateY(20px)';
                }
            });
        }
        
        // Apply initial styles for scroll animation
        sections.forEach(section => {
            if (section !== heroSection) { // Exclude hero section from initial fade-in
                section.style.opacity = '0';
                section.style.transform = 'translateY(20px)';
                section.style.transition = 'opacity 0.6s ease-out, transform 0.6s ease-out';
            }
        });
        
        window.addEventListener('load', checkScroll);
        window.addEventListener('scroll', checkScroll, { passive: true }); // Use passive listener for scroll performance

        // Modal JavaScript
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) modal.style.display = "block";
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) modal.style.display = "none";
        }

        // Close modal if user clicks anywhere outside of the modal content
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = "none";
            }
        }
        // Close modal with ESC key
        window.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                document.querySelectorAll('.modal').forEach(modal => {
                    if (modal.style.display === 'block') {
                        modal.style.display = 'none';
                    }
                });
            }
        });

        // 3D Particle Morphing Mosaic Sketch
        function createParticleMorphingSketch() {
            return function(p) {
                let particles = [];
                const numParticles = 300; // Number of particles
                let currentFormation = 0;
                const formations = ['scatter', 'sphere', 'grid', 'icosahedron', 'rings'];
                let formationChangeInterval;
                const particleSize = 5; // Size of the cube particles
                let lerpFactor = 0.03; // Speed of morphing

                // Colors from CSS variables (will be parsed)
                let teBlack, teYellow, accentGold, parchment;

                // Particle class
                class Particle {
                    constructor(x, y, z) {
                        this.pos = p.createVector(x, y, z);
                        this.targetPos = p.createVector(x, y, z);
                        this.vel = p.createVector();
                        this.acc = p.createVector();
                        this.color = teBlack; // Default color
                        this.originalColor = teBlack;
                    }

                    // Apply force for movement
                    applyForce(force) {
                        this.acc.add(force);
                    }

                    // Update particle position
                    update() {
                        // Morphing behavior
                        this.pos.lerp(this.targetPos, lerpFactor);

                        // Add some subtle random movement if desired (optional)
                        // this.vel.add(p5.Vector.random3D().mult(0.05));
                        // this.pos.add(this.vel);
                        // this.vel.limit(0.5);
                    }

                    // Set a new target position for morphing
                    setTarget(newTargetX, newTargetY, newTargetZ) {
                        this.targetPos.set(newTargetX, newTargetY, newTargetZ);
                    }
                    
                    // Set particle color
                    setColor(col) {
                        this.color = col;
                        this.originalColor = col;
                    }

                    // Display the particle
                    display() {
                        p.push();
                        p.translate(this.pos.x, this.pos.y, this.pos.z);
                        p.fill(this.color);
                        p.noStroke();
                        p.box(particleSize); // Draw particle as a cube
                        p.pop();
                    }
                }

                p.setup = function() {
                    // Get colors from CSS variables after DOM is loaded
                    const styles = getComputedStyle(document.documentElement);
                    teBlack = p.color(styles.getPropertyValue('--te-black').trim() || '#1A1A1A');
                    teYellow = p.color(styles.getPropertyValue('--te-yellow').trim() || '#FFE03D');
                    accentGold = p.color(styles.getPropertyValue('--accent-gold').trim() || '#D4AF37');
                    parchment = p.color(styles.getPropertyValue('--parchment').trim() || '#F5F2E9');

                    let canvas = p.createCanvas(p.windowWidth, p.windowHeight, p.WEBGL);
                    canvas.parent('p5-container'); // Attach canvas to the container
                    
                    // Initialize particles
                    for (let i = 0; i < numParticles; i++) {
                        // Initial random positions within a sphere
                        let r = p.random(p.min(p.width, p.height) / 4, p.min(p.width, p.height) / 3);
                        let theta = p.random(p.TWO_PI);
                        let phi = p.random(p.PI);
                        let x = r * p.sin(phi) * p.cos(theta);
                        let y = r * p.sin(phi) * p.sin(theta);
                        let z = r * p.cos(phi);
                        particles[i] = new Particle(x, y, z);
                        
                        // Assign colors (mix of TE Black, with some Gold/Yellow accents)
                        if (p.random(1) < 0.1) {
                            particles[i].setColor(teYellow);
                        } else if (p.random(1) < 0.2) {
                            particles[i].setColor(accentGold);
                        } else {
                            particles[i].setColor(teBlack);
                        }
                    }
                    
                    // Set initial formation
                    changeFormation(); 
                    // Change formation every 7 seconds
                    formationChangeInterval = setInterval(changeFormation, 7000);

                    // Allow mouse control for camera
                    p.orbitControl(2, 2, 0.1); // (sensitivityX, sensitivityY, sensitivityZoom)
                };

                p.draw = function() {
                    p.background(0, 0, 0, 0); // Transparent background for the canvas itself
                                            // The .hero section provides the --te-black background
                    p.ambientLight(150); // Soft ambient light
                    p.directionalLight(255, 255, 250, 0.5, 0.5, -1); // A light source

                    // Update and display particles
                    for (let particle of particles) {
                        particle.update();
                        particle.display();
                    }
                };

                // Function to change the particle formation
                function changeFormation() {
                    currentFormation = (currentFormation + 1) % formations.length;
                    let formationType = formations[currentFormation];
                    // console.log("Changing formation to: " + formationType);

                    switch (formationType) {
                        case 'scatter':
                            setScatterFormation();
                            break;
                        case 'sphere':
                            setSphereFormation(p.min(p.width, p.height) / 3.5);
                            break;
                        case 'grid':
                            setGridFormation(10, 100); // 10 particles per side, 100 unit spacing
                            break;
                        case 'icosahedron':
                            setIcosahedronFormation(p.min(p.width, p.height) / 3);
                            break;
                        case 'rings':
                            setRingFormation(p.min(p.width, p.height) / 4, 3, 50); // Base radius, num rings, ring spacing
                            break;
                    }
                }

                // Formation: Random Scatter (within a larger sphere)
                function setScatterFormation() {
                    for (let particle of particles) {
                        let r = p.random(p.min(p.width, p.height) / 2.5, p.min(p.width, p.height) / 2);
                        let theta = p.random(p.TWO_PI);
                        let phi = p.random(p.PI);
                        particle.setTarget(
                            r * p.sin(phi) * p.cos(theta),
                            r * p.sin(phi) * p.sin(theta),
                            r * p.cos(phi)
                        );
                    }
                }

                // Formation: Sphere
                function setSphereFormation(radius) {
                    for (let i = 0; i < particles.length; i++) {
                        // Distribute points evenly on a sphere using Fibonacci lattice
                        const phi = Math.acos(-1 + (2 * i) / particles.length);
                        const theta = Math.sqrt(particles.length * Math.PI) * phi;
                        
                        particles[i].setTarget(
                            radius * p.cos(theta) * p.sin(phi),
                            radius * p.sin(theta) * p.sin(phi),
                            radius * p.cos(phi)
                        );
                    }
                }

                // Formation: 3D Grid (Mosaic)
                function setGridFormation(particlesPerSide, spacing) {
                    let sideLength = Math.cbrt(numParticles); // Approximate for a cube
                    sideLength = Math.max(2, Math.floor(sideLength)); // Ensure at least 2
                    let particleIndex = 0;
                    const offset = - (sideLength -1) * spacing / 2;

                    for (let x = 0; x < sideLength; x++) {
                        for (let y = 0; y < sideLength; y++) {
                            for (let z = 0; z < sideLength; z++) {
                                if (particleIndex < numParticles) {
                                    particles[particleIndex].setTarget(
                                        offset + x * spacing,
                                        offset + y * spacing,
                                        offset + z * spacing
                                    );
                                    particleIndex++;
                                } else { break; }
                            }
                            if (particleIndex >= numParticles) break;
                        }
                        if (particleIndex >= numParticles) break;
                    }
                    // Any remaining particles can go to origin or scatter
                    for (let i = particleIndex; i < numParticles; i++) {
                        particles[i].setTarget(0,0,0);
                    }
                }

                // Formation: Icosahedron (particles at vertices)
                function setIcosahedronFormation(radius) {
                    const t = (1 + Math.sqrt(5)) / 2; // Golden ratio
                    const icosahedronVertices = [
                        p.createVector(-1,  t,  0), p.createVector( 1,  t,  0), p.createVector(-1, -t,  0), p.createVector( 1, -t,  0),
                        p.createVector( 0, -1,  t), p.createVector( 0,  1,  t), p.createVector( 0, -1, -t), p.createVector( 0,  1, -t),
                        p.createVector( t,  0, -1), p.createVector( t,  0,  1), p.createVector(-t,  0, -1), p.createVector(-t,  0,  1)
                    ];

                    for (let i = 0; i < particles.length; i++) {
                        // Cycle through vertices for all particles
                        const v = icosahedronVertices[i % icosahedronVertices.length].copy().mult(radius / t); // Scale to radius
                        particles[i].setTarget(v.x, v.y, v.z);
                    }
                }
                
                // Formation: Concentric Rings (TE Inspired)
                function setRingFormation(baseRadius, numRings, ringSpacing) {
                    let particleIndex = 0;
                    const particlesPerRingApprox = Math.floor(numParticles / numRings);

                    for (let r = 0; r < numRings; r++) {
                        const currentRadius = baseRadius + r * ringSpacing;
                        const particlesInThisRing = (r === numRings - 1) ? (numParticles - particleIndex) : particlesPerRingApprox;
                        
                        for (let i = 0; i < particlesInThisRing; i++) {
                            if (particleIndex < numParticles) {
                                const angle = p.map(i, 0, particlesInThisRing, 0, p.TWO_PI);
                                // Rings can be in XY, XZ, or YZ plane, or rotate
                                const x = currentRadius * p.cos(angle);
                                const y = currentRadius * p.sin(angle);
                                const z = r * 10 - (numRings * 10 / 2); // Stagger rings along Z
                                
                                particles[particleIndex].setTarget(x, y, z);
                                particleIndex++;
                            } else { break; }
                        }
                        if (particleIndex >= numParticles) break;
                    }
                     // Any remaining particles
                    for (let i = particleIndex; i < numParticles; i++) {
                        particles[i].setTarget(0,0,0);
                    }
                }


                // Handle window resize
                p.windowResized = function() {
                    p.resizeCanvas(p.windowWidth, p.windowHeight);
                    // Perspective might need adjustment if custom, but default should handle it
                    // Re-trigger current formation to adjust to new size if needed
                     switch (formations[currentFormation]) {
                        case 'scatter': setScatterFormation(); break;
                        case 'sphere': setSphereFormation(p.min(p.width, p.height) / 3.5); break;
                        case 'grid': setGridFormation(10, p.min(p.width,p.height)/15); break; // Adjust spacing
                        case 'icosahedron': setIcosahedronFormation(p.min(p.width, p.height) / 3); break;
                        case 'rings': setRingFormation(p.min(p.width, p.height) / 4, 3, p.min(p.width,p.height)/20); break; // Adjust spacing
                    }
                };

                // Cleanup when sketch is removed (e.g., for hot reloading or page navigation)
                p.remove = function() {
                    clearInterval(formationChangeInterval);
                }
            };
        }
        
        // Initialize p5.js sketch
        let myp5 = new p5(createParticleMorphingSketch());

    </script>
</body>
</html>
